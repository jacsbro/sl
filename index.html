<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <title>Shoppinglist App</title>

  <link rel="shortcut icon" sizes="32x32" href="images/app-icon-32.png">

  <meta name="theme-color" content="#fff">
  <link rel="manifest" href="manifest.json">

  <script>

    ////////////////////////////////////////////////////////////////////////////
    // setup Polymer options
    ////////////////////////////////////////////////////////////////////////////
    window.Polymer = {lazyRegister: true, dom: 'shadow'};

    // load webcomponents polyfills
    (function() {
      if ('registerElement' in document
          && 'import' in document.createElement('link')
          && 'content' in document.createElement('template')) {
        // browser has web components
      } else {
        // polyfill web components
        var e = document.createElement('script');
        e.src = 'bower_components/webcomponentsjs/webcomponents-lite.min.js';
        document.head.appendChild(e);
      }
    })();

    // load pre-caching service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js');
      });
    }

  </script>

  <!--
  <script src="https://www.gstatic.com/firebasejs/3.3.2/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.3.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.3.0/firebase-storage.js"></script>
-->
  <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCE1JCQXckJCf_j7keblp38y4Q9BIAagbM",
      authDomain: "shoppinglist-3ec51.firebaseapp.com",
      databaseURL: "https://shoppinglist-3ec51.firebaseio.com",
      storageBucket: "shoppinglist-3ec51.appspot.com",
    };
    firebase.initializeApp(config);
    // Get a reference to the storage service, which is used to create references in your storage bucket
    //var storage = firebase.storage();

    // Get a reference to the database service
    var database = firebase.database();
  </script>

  <script src="https://www.gstatic.com/firebasejs/ui/live/0.5/firebase-ui-auth.js"></script>
  <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/live/0.5/firebase-ui-auth.css" />
  <script type="text/javascript">
    // FirebaseUI config.
    var uiConfig = {
      'signInSuccessUrl': '<url-to-redirect-to-on-success>',
      'signInOptions': [
        firebase.auth.EmailAuthProvider.PROVIDER_ID
      ],
      'callbacks': {
          'signInSuccess': function(currentUser, credential, redirectUrl) {
            console.log('sucessful login');

            var dynamicEl = document.createElement("my-app");
            dynamicEl.id = "app";
            document.body.appendChild(dynamicEl);

            var e1 = document.createElement('script');
            e1.src = 'src/app.js';
            document.head.appendChild(e1);

            var e2 = document.createElement('script');
            e2.src = 'src/ShoppingList.js';
            document.head.appendChild(e2);

            app.firebase = firebase;
            app.firebaseUser = currentUser;
            console.log(app.firebaseUser);

            return false;
          }
      }
    };

    // Initialize the FirebaseUI Widget using Firebase.
    var ui = new firebaseui.auth.AuthUI(firebase.auth());
    // The start method will wait until the DOM is loaded.
    ui.start('#firebaseui-auth-container', uiConfig);
  </script>



  <link rel="import" href="src/my-app.html">

  <style>

    body {
      margin: 0;
      font-family: 'Roboto', 'Noto', sans-serif;
      /* looks bad on mac
      font-family: 'DejaVuSansBook','Arial,Helvetica','sans-serif';
      */
      font-size: 90%;
      line-height: 1.5;
      min-height: 100vh;
      background-color: #eee;
    }

  </style>

</head>
<body>

  <div id="firebaseui-auth-container"></div>

  <!-- app
  <my-app id="app"></my-app>
  <script src="src/app.js"></script>
  <script src="src/ShoppingList.js"></script>
  -->

</body>
</html>
